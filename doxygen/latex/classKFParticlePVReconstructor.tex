\hypertarget{classKFParticlePVReconstructor}{}\section{K\+F\+Particle\+P\+V\+Reconstructor Class Reference}
\label{classKFParticlePVReconstructor}\index{K\+F\+Particle\+P\+V\+Reconstructor@{K\+F\+Particle\+P\+V\+Reconstructor}}


Class for reconstruction of primary vertices.  




{\ttfamily \#include $<$K\+F\+Particle\+P\+V\+Reconstructor.\+h$>$}

\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
void \hyperlink{classKFParticlePVReconstructor_ad11ac3f6bd43c9fcaf0b67958b41e456}{Init} (\hyperlink{classKFPTrackVector}{K\+F\+P\+Track\+Vector} $\ast$tracks, int n\+Particles)
\item 
void \hyperlink{classKFParticlePVReconstructor_aac8016012886979bbbc71f42a617ad3a}{Reconstruct\+Prim\+Vertex} ()
\item 
int \hyperlink{classKFParticlePVReconstructor_ae2a4ab31383ced56306c3b9bb08deb54}{N\+Primary\+Vertices} () const \hypertarget{classKFParticlePVReconstructor_ae2a4ab31383ced56306c3b9bb08deb54}{}\label{classKFParticlePVReconstructor_ae2a4ab31383ced56306c3b9bb08deb54}

\begin{DoxyCompactList}\small\item\em Returns number of the found candidates for the primary vertex. \end{DoxyCompactList}\item 
\hyperlink{classKFParticle}{K\+F\+Particle} \& \hyperlink{classKFParticlePVReconstructor_a8ecf4029dcd674d8baf068e1540ec413}{Get\+Prim\+Vertex} (int i\+PV=0)\hypertarget{classKFParticlePVReconstructor_a8ecf4029dcd674d8baf068e1540ec413}{}\label{classKFParticlePVReconstructor_a8ecf4029dcd674d8baf068e1540ec413}

\begin{DoxyCompactList}\small\item\em Returns primary vertex candidate in \hyperlink{classKFParticle}{K\+F\+Particle} with index \char`\"{}i\+P\+V\char`\"{}. \end{DoxyCompactList}\item 
\hyperlink{classKFVertex}{K\+F\+Vertex} \& \hyperlink{classKFParticlePVReconstructor_ab3203efd8e779ab6ad14120c97dce7f2}{Get\+Prim\+K\+F\+Vertex} (int i\+PV=0)\hypertarget{classKFParticlePVReconstructor_ab3203efd8e779ab6ad14120c97dce7f2}{}\label{classKFParticlePVReconstructor_ab3203efd8e779ab6ad14120c97dce7f2}

\begin{DoxyCompactList}\small\item\em Returns primary vertex candidate in \hyperlink{classKFVertex}{K\+F\+Vertex} with index \char`\"{}i\+P\+V\char`\"{}. \end{DoxyCompactList}\item 
std\+::vector$<$ int $>$ \& \hyperlink{classKFParticlePVReconstructor_a5fd10eaad4fef141774e7081cc9e07f9}{Get\+P\+V\+Track\+Index\+Array} (int i\+PV=0)\hypertarget{classKFParticlePVReconstructor_a5fd10eaad4fef141774e7081cc9e07f9}{}\label{classKFParticlePVReconstructor_a5fd10eaad4fef141774e7081cc9e07f9}

\begin{DoxyCompactList}\small\item\em Returns vector with track indices from a cluster with index \char`\"{}i\+P\+V\char`\"{}. \end{DoxyCompactList}\item 
\hyperlink{classKFParticle}{K\+F\+Particle} \& \hyperlink{classKFParticlePVReconstructor_ab11011d9ec1bfe74140b8d6ccd3694de}{Get\+Particle} (int i)\hypertarget{classKFParticlePVReconstructor_ab11011d9ec1bfe74140b8d6ccd3694de}{}\label{classKFParticlePVReconstructor_ab11011d9ec1bfe74140b8d6ccd3694de}

\begin{DoxyCompactList}\small\item\em Returns input particle with index \char`\"{}i\char`\"{}. \end{DoxyCompactList}\item 
void \hyperlink{classKFParticlePVReconstructor_a5ab2c38c5b8191d733df5a086d6b1752}{Set\+Beam\+Line} (\hyperlink{classKFParticle}{K\+F\+Particle} \&p)\hypertarget{classKFParticlePVReconstructor_a5ab2c38c5b8191d733df5a086d6b1752}{}\label{classKFParticlePVReconstructor_a5ab2c38c5b8191d733df5a086d6b1752}

\begin{DoxyCompactList}\small\item\em Sets the beam line position and direction, sets corresponding flag to \char`\"{}true\char`\"{}. \end{DoxyCompactList}\item 
bool \hyperlink{classKFParticlePVReconstructor_a9440698721919c5168aa4996cea62296}{Is\+Beam\+Line} () const \hypertarget{classKFParticlePVReconstructor_a9440698721919c5168aa4996cea62296}{}\label{classKFParticlePVReconstructor_a9440698721919c5168aa4996cea62296}

\begin{DoxyCompactList}\small\item\em Check if the beam line is set. \end{DoxyCompactList}\item 
void \hyperlink{classKFParticlePVReconstructor_ac236151a1e4e21643e55747e7777bccb}{Add\+PV} (const \hyperlink{classKFVertex}{K\+F\+Vertex} \&pv, const std\+::vector$<$ int $>$ \&tracks)
\item 
void \hyperlink{classKFParticlePVReconstructor_a44b9ad35e87fa7feb800bd6abaa7f26f}{Add\+PV} (const \hyperlink{classKFVertex}{K\+F\+Vertex} \&pv)
\item 
void \hyperlink{classKFParticlePVReconstructor_a6da36a34efc1fc8eb3abb86280e52656}{Clean\+PV} ()\hypertarget{classKFParticlePVReconstructor_a6da36a34efc1fc8eb3abb86280e52656}{}\label{classKFParticlePVReconstructor_a6da36a34efc1fc8eb3abb86280e52656}

\begin{DoxyCompactList}\small\item\em Clean vectors with primary vertex candidates and corresponding clusters. \end{DoxyCompactList}\item 
void \hyperlink{classKFParticlePVReconstructor_a390f47b8bd5c6fbe5a82c3cf9d473d06}{Set\+Chi2\+Primary\+Cut} (float chi2)\hypertarget{classKFParticlePVReconstructor_a390f47b8bd5c6fbe5a82c3cf9d473d06}{}\label{classKFParticlePVReconstructor_a390f47b8bd5c6fbe5a82c3cf9d473d06}

\begin{DoxyCompactList}\small\item\em Sets cut f\+Chi2\+Cut on chi2-\/deviation of primary tracks from the vertex candidate to \char`\"{}chi2\char`\"{} and a soft preparation cut f\+Chi2\+Cut\+Preparation to \char`\"{}10$\ast$chi2\char`\"{}. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
Class for reconstruction of primary vertices. 

\begin{DoxyAuthor}{Author}
I.\+Kisel, M.\+Zyzak 
\end{DoxyAuthor}
\begin{DoxyDate}{Date}
05.\+02.\+2019 
\end{DoxyDate}
\begin{DoxyVersion}{Version}
1.\+0
\end{DoxyVersion}
The class is based on \hyperlink{classKFVertex}{K\+F\+Vertex}. For reconstruction of primary vertices the Kalman filter mathematics is used. Allows reconstruction of multiple primary vertices. 

\subsection{Member Function Documentation}
\index{K\+F\+Particle\+P\+V\+Reconstructor@{K\+F\+Particle\+P\+V\+Reconstructor}!Add\+PV@{Add\+PV}}
\index{Add\+PV@{Add\+PV}!K\+F\+Particle\+P\+V\+Reconstructor@{K\+F\+Particle\+P\+V\+Reconstructor}}
\subsubsection[{\texorpdfstring{Add\+P\+V(const K\+F\+Vertex \&pv, const std\+::vector$<$ int $>$ \&tracks)}{AddPV(const KFVertex &pv, const std::vector< int > &tracks)}}]{\setlength{\rightskip}{0pt plus 5cm}void K\+F\+Particle\+P\+V\+Reconstructor\+::\+Add\+PV (
\begin{DoxyParamCaption}
\item[{const {\bf K\+F\+Vertex} \&}]{pv, }
\item[{const std\+::vector$<$ int $>$ \&}]{tracks}
\end{DoxyParamCaption}
)}\hypertarget{classKFParticlePVReconstructor_ac236151a1e4e21643e55747e7777bccb}{}\label{classKFParticlePVReconstructor_ac236151a1e4e21643e55747e7777bccb}
Adds externally found primary vertex to the list together with the cluster of tracks from this vertex. 
\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em pv} & -\/ external primary vertex \\
\hline
\mbox{\tt in}  & {\em tracks} & -\/ vector with indices of tracks associated with the provided primary vertex. \\
\hline
\end{DoxyParams}
\index{K\+F\+Particle\+P\+V\+Reconstructor@{K\+F\+Particle\+P\+V\+Reconstructor}!Add\+PV@{Add\+PV}}
\index{Add\+PV@{Add\+PV}!K\+F\+Particle\+P\+V\+Reconstructor@{K\+F\+Particle\+P\+V\+Reconstructor}}
\subsubsection[{\texorpdfstring{Add\+P\+V(const K\+F\+Vertex \&pv)}{AddPV(const KFVertex &pv)}}]{\setlength{\rightskip}{0pt plus 5cm}void K\+F\+Particle\+P\+V\+Reconstructor\+::\+Add\+PV (
\begin{DoxyParamCaption}
\item[{const {\bf K\+F\+Vertex} \&}]{pv}
\end{DoxyParamCaption}
)}\hypertarget{classKFParticlePVReconstructor_a44b9ad35e87fa7feb800bd6abaa7f26f}{}\label{classKFParticlePVReconstructor_a44b9ad35e87fa7feb800bd6abaa7f26f}
Adds externally found primary vertex to the list. 
\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em pv} & -\/ external primary vertex \\
\hline
\end{DoxyParams}
\index{K\+F\+Particle\+P\+V\+Reconstructor@{K\+F\+Particle\+P\+V\+Reconstructor}!Init@{Init}}
\index{Init@{Init}!K\+F\+Particle\+P\+V\+Reconstructor@{K\+F\+Particle\+P\+V\+Reconstructor}}
\subsubsection[{\texorpdfstring{Init(\+K\+F\+P\+Track\+Vector $\ast$tracks, int n\+Particles)}{Init(KFPTrackVector *tracks, int nParticles)}}]{\setlength{\rightskip}{0pt plus 5cm}void K\+F\+Particle\+P\+V\+Reconstructor\+::\+Init (
\begin{DoxyParamCaption}
\item[{{\bf K\+F\+P\+Track\+Vector} $\ast$}]{tracks, }
\item[{int}]{n\+Particles}
\end{DoxyParamCaption}
)}\hypertarget{classKFParticlePVReconstructor_ad11ac3f6bd43c9fcaf0b67958b41e456}{}\label{classKFParticlePVReconstructor_ad11ac3f6bd43c9fcaf0b67958b41e456}
The function initialises an input for the search of primary vertices\+:~\newline
1) it receives as an input an array with tracks;~\newline
2) tracks are converted to \hyperlink{classKFParticle}{K\+F\+Particle} objects assuming pion mass;~\newline
3) the position of the primary vertex is estimated with simplified Kalman filter equations using all tracks; ~\newline
4) tracks are checked to deviate from the obtained estimation within K\+F\+Particle\+P\+V\+Reconstructor\+::f\+Chi2\+Cut\+Preparation; ~\newline
5) from the selected tracks a more precise estimation is obtained using \hyperlink{classKFVertex_a0398208d64532d964a2c6c4c061c349c}{K\+F\+Vertex\+::\+Construct\+Primary\+Vertex()} with soft cut K\+F\+Particle\+P\+V\+Reconstructor\+::f\+Chi2\+Cut\+Preparation; ~\newline
6) input particles are transported to the D\+CA point with the obtained estimation;~\newline
7) the weight for each particle is calculated according to its errors, if errors are not defined after extrapolation or if particle 10 cm away from the \{0,0,0\} point the weight of -\/100 is assigned. 
\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em tracks} & -\/ a pointer to the \hyperlink{classKFPTrackVector}{K\+F\+P\+Track\+Vector} with input tracks \\
\hline
\mbox{\tt in}  & {\em n\+Particles} & -\/ number of the input tracks\\
\hline
\end{DoxyParams}
\index{K\+F\+Particle\+P\+V\+Reconstructor@{K\+F\+Particle\+P\+V\+Reconstructor}!Reconstruct\+Prim\+Vertex@{Reconstruct\+Prim\+Vertex}}
\index{Reconstruct\+Prim\+Vertex@{Reconstruct\+Prim\+Vertex}!K\+F\+Particle\+P\+V\+Reconstructor@{K\+F\+Particle\+P\+V\+Reconstructor}}
\subsubsection[{\texorpdfstring{Reconstruct\+Prim\+Vertex()}{ReconstructPrimVertex()}}]{\setlength{\rightskip}{0pt plus 5cm}void K\+F\+Particle\+P\+V\+Reconstructor\+::\+Reconstruct\+Prim\+Vertex (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}\hypertarget{classKFParticlePVReconstructor_aac8016012886979bbbc71f42a617ad3a}{}\label{classKFParticlePVReconstructor_aac8016012886979bbbc71f42a617ad3a}
Reconstructs primary vertices and corresponding clusters of tracks. For this it calls K\+F\+Particle\+P\+V\+Reconstructor\+::\+Find\+Primary\+Clusters(), if no vertex is found empty primary vertex is used.

The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
/home/user/cbmdir/kfpf/\+K\+F\+Particle/\+K\+F\+Particle/K\+F\+Particle\+P\+V\+Reconstructor.\+h\item 
/home/user/cbmdir/kfpf/\+K\+F\+Particle/\+K\+F\+Particle/K\+F\+Particle\+P\+V\+Reconstructor.\+cxx\end{DoxyCompactItemize}
